(FormBuilder=FormBuilder||{}).Admin=FormBuilder.Admin||{},FormBuilder.Admin.Conditional=function(e){function t(){e(document).ready(function(){"mod-form"==pagenow&&(this.populateSelectFields(),this.handleEvents())}.bind(this))}return t.prototype.populateSelectFields=function(){e('[data-name="conditonal_field"] select').each(function(t,o){var i="",n=e(":selected",o);if(n.val())i=n.val();else{var a=e(o).attr("name");e.ajax({url:ajaxurl,type:"post",data:{action:"get_selected_field",moduleId:modularity_current_post_id,fieldName:a},success:function(t){"error"!=t&&e("option[value='"+t+"']",o).prop("selected",!0)}})}e("optgroup, option",o).remove();var r=this.getOptions();void 0!==r&&r.length>0?(e(".condition-missing").remove(),e.each(r,function(t,n){var a="";e.each(n.selectvalues,function(e,t){var o={label:this.conditionalString(n.groupLabel),value:this.conditionalString(t)};a+="<option value='"+JSON.stringify(o)+"'>"+t+"</option>"}.bind(this));var r='<optgroup label="'+n.groupLabel+'">'+a+"</optgroup>";e(o).append(r),i&&e("option[value='"+i+"']",o).prop("selected",!0)}.bind(this))):(e(".condition-missing").remove(),e('<p class="condition-missing">'+formbuilder.selections_missing+"</p>").insertBefore(o))}.bind(this))},t.prototype.getOptions=function(t){var o=[];return e('[data-layout="radio"]:not(.acf-clone)').each(function(t,i){var n={groupLabel:e(i).find('[data-name="label"] input').val(),selectvalues:[]};e('[data-key="field_58eb670d39fef"] table tbody',i).children("tr.acf-row:not(.acf-clone)").each(function(t,o){var i=e(o).find('[data-name="value"] input').val();n.selectvalues.push(i)}),o.push(n)}),o},t.prototype.conditionalString=function(e){return e=e.toLowerCase(),e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_]+/gi,""),e=e.replace(/_+$/,"")},t.prototype.handleEvents=function(){e(document).on("click",'[data-name="conditional_logic"] [type="checkbox"], [data-layout="radio"] .acf-row-handle > a',function(){this.populateSelectFields()}.bind(this))},new t}(jQuery),(FormBuilder=FormBuilder||{}).Admin=FormBuilder.Admin||{},FormBuilder.Admin.EditForm=function(e){function t(){e(function(){this.handleEvents()}.bind(this))}return t.prototype.deleteFile=function(t,o,i,n,a){e.ajax({url:ajaxurl,type:"post",data:{action:"delete_file",postId:t,formId:o,filePath:i,fieldName:n},beforeSend:function(e){a.remove()},error:function(e,t,o){console.log("Error: "+t)}})},t.prototype.uploadFile=function(t,o,i,n,a){var r=new FormData;r.append("action","upload_files"),r.append("postId",o),r.append("formId",i),r.append("fieldName",n),e.each(t,function(e,t){r.append(n+"[]",t)}),e.ajax({url:ajaxurl,type:"POST",data:r,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(t){e("input[type=file]",a).hide(),e(".upload-status",a).html('<p><div class="spinner is-active" style="float:left;"></div> '+formbuilder.uploading+"</p>")},success:function(t,o,i){t.success?e(":submit","#publishing-action").trigger("click"):(e(".upload-status",a).html("<p>"+t.data+"</p>"),e("input[type=file]",a).show())},error:function(t,o,i){console.log("error: "+o),e("input[type=file]",a).show(),e(".upload-status",a).hide()}})},t.prototype.handleEvents=function(){e(document).on("click",".delete-form-file",function(t){if(t.preventDefault(),window.confirm(formbuilder.delete_confirm)){var o=e(t.target).attr("postid"),i=e(t.target).attr("formid"),n=e(t.target).attr("filepath"),a=e(t.target).attr("fieldname"),r=e(t.target).parents("li");this.deleteFile(o,i,n,a,r)}}.bind(this)),e(document).on("change","input[type=file]",function(t){var o=t.target.files;postId=e(t.target).attr("postid"),formId=e(t.target).attr("formid"),fieldName=e(t.target).attr("fieldname"),$target=e(t.target).parents(".mod-form-field"),this.uploadFile(o,postId,formId,fieldName,$target)}.bind(this))},new t}(jQuery);var FormBuilder=FormBuilder||{};(FormBuilder=FormBuilder||{}).Admin=FormBuilder.Admin||{},FormBuilder.Admin.various=function(e){function t(){e(function(){this.externalUpload()}.bind(this))}return t.prototype.externalUpload=function(){formbuilder.mod_form_authorized||e('[data-name="upload_videos_external"]').hide()},new t}(jQuery);