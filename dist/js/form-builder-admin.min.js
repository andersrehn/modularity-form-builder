(FormBuilder=FormBuilder||{}).Admin=FormBuilder.Admin||{},FormBuilder.Admin.Conditional=function(e){function t(){e(document).ready(function(){this.populateSelectFields(),this.handleEvents()}.bind(this))}return t.prototype.populateSelectFields=function(){e('[data-name="conditonal_field"] select').each(function(t,n){var i="",o=e(":selected",n);if(o.val())i=o.val();else{var a=e(n).attr("name");e.ajax({url:ajaxurl,type:"post",data:{action:"get_selected_field",moduleId:modularity_current_post_id,fieldName:a},success:function(t){"error"!=t&&e("option[value='"+t+"']",n).prop("selected",!0)}})}e("optgroup, option",n).remove();var r=this.getOptions();void 0!==r&&r.length>0?(e(".condition-missing").remove(),e.each(r,function(t,o){var a="";e.each(o.selectvalues,function(e,t){var n={label:this.conditionalString(o.groupLabel),value:this.conditionalString(t)};a+="<option value='"+JSON.stringify(n)+"'>"+t+"</option>"}.bind(this));var r='<optgroup label="'+o.groupLabel+'">'+a+"</optgroup>";e(n).append(r),i&&e("option[value='"+i+"']",n).prop("selected",!0)}.bind(this))):(e(".condition-missing").remove(),e('<p class="condition-missing">'+formbuilder.selections_missing+"</p>").insertBefore(n))}.bind(this))},t.prototype.getOptions=function(t){var n=[];return e('[data-layout="radio"]:not(.acf-clone)').each(function(t,i){var o={groupLabel:e(i).find('[data-name="label"] input').val(),selectvalues:[]};e('[data-key="field_58eb670d39fef"] table tbody',i).children("tr.acf-row:not(.acf-clone)").each(function(t,n){var i=e(n).find('[data-name="value"] input').val();o.selectvalues.push(i)}),n.push(o)}),n},t.prototype.conditionalString=function(e){return e=e.toLowerCase(),e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_]+/gi,""),e=e.replace(/_+$/,"")},t.prototype.handleEvents=function(){e(document).on("click",'[data-name="conditional_logic"] [type="checkbox"], [data-layout="radio"] .acf-row-handle > a',function(){this.populateSelectFields()}.bind(this))},new t}(jQuery),(FormBuilder=FormBuilder||{}).Admin=FormBuilder.Admin||{},FormBuilder.Admin.EditForm=function(e){function t(){e(function(){this.handleEvents()}.bind(this))}return t.prototype.deleteFile=function(t,n,i,o,a){e.ajax({url:ajaxurl,type:"post",data:{action:"delete_file",postId:t,formId:n,filePath:i,fieldName:o},beforeSend:function(e){a.remove()},error:function(e,t,n){console.log("Error: "+t)}})},t.prototype.uploadFile=function(t,n,i,o,a){var r=new FormData;r.append("action","upload_files"),r.append("postId",n),r.append("formId",i),r.append("fieldName",o),e.each(t,function(e,t){r.append(o+"[]",t)}),e.ajax({url:ajaxurl,type:"POST",data:r,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(t){e("input[type=file]",a).hide(),e(".upload-status",a).html('<div class="spinner spinner-dark is-active" style="float:none;"></div>')},success:function(t,n,i){t.success&&e(":submit","#publishing-action,#edit-post").trigger("click"),e(".upload-status",a).html("<p>"+t.data+"</p>"),e("input[type=file]",a).show()},error:function(t,n){console.log("error: "+n),e("input[type=file]",a).show(),e(".upload-status",a).hide()}})},t.prototype.savePost=function(t){var n=e(t.target),i=new FormData(t.target);return i.append("action","save_post"),n.find('button[type="submit"]').attr("disabled","true").append('<span class="spinner"></span>'),e.ajax({url:ajaxurl,type:"POST",data:i,dataType:"json",processData:!1,contentType:!1,success:function(t){t.success?n.find('button[type="submit"]').append('<i class="pricon pricon-check"></i>').find(".spinner").hide():e(".modal-footer",n).html('<span class="notice warning"><i class="pricon pricon-notice-warning"></i> '+t.data+"</span>")},complete:function(){location.hash="",location.reload()}}),!1},t.prototype.handleEvents=function(){e(document).on("submit","#edit-post",function(e){e.preventDefault(),this.savePost(e)}.bind(this)),e(document).on("click",".delete-form-file",function(t){if(t.preventDefault(),window.confirm(formbuilder.delete_confirm)){var n=e(t.target).attr("postid"),i=e(t.target).attr("formid"),o=e(t.target).attr("filepath"),a=e(t.target).attr("fieldname"),r=e(t.target).parents("span");this.deleteFile(n,i,o,a,r)}}.bind(this)),e(document).on("change","input[type=file]",function(t){var n=t.target.files,i=e(t.target).attr("postid"),o=e(t.target).attr("formid"),a=e(t.target).attr("fieldname"),r=e(t.target).parents(".mod-form-field");this.uploadFile(n,i,o,a,r)}.bind(this))},new t}(jQuery);var FormBuilder=FormBuilder||{};(FormBuilder=FormBuilder||{}).Admin=FormBuilder.Admin||{},FormBuilder.Admin.various=function(e){function t(){e(function(){this.externalUpload()}.bind(this))}return t.prototype.externalUpload=function(){formbuilder.mod_form_authorized||e('[data-name="upload_videos_external"]').hide()},new t}(jQuery);