var FormBuilder=FormBuilder||{};(FormBuilder=FormBuilder||{}).Admin=FormBuilder.Admin||{},FormBuilder.Admin.Conditional=function(e){function t(){e(document).ready(function(){"mod-form"==pagenow&&(this.populateSelectFields(),this.handleEvents())}.bind(this))}return t.prototype.populateSelectFields=function(){e('[data-name="conditonal_field"] select').each(function(t,o){var n="",i=e(":selected",o);if(i.val())n=i.val();else{var a=e(o).attr("name");e.ajax({url:ajaxurl,type:"post",data:{action:"get_selected_field",moduleId:modularity_current_post_id,fieldName:a},success:function(t){"error"!=t&&e("option[value='"+t+"']",o).prop("selected",!0)}})}e("optgroup, option",o).remove();var l=this.getOptions();void 0!==l&&l.length>0?(e(".condition-missing").remove(),e.each(l,function(t,i){var a="";e.each(i.selectvalues,function(e,t){var o={label:this.conditionalString(i.groupLabel),value:this.conditionalString(t)};a+="<option value='"+JSON.stringify(o)+"'>"+t+"</option>"}.bind(this));var l='<optgroup label="'+i.groupLabel+'">'+a+"</optgroup>";e(o).append(l),n&&e("option[value='"+n+"']",o).prop("selected",!0)}.bind(this))):(e(".condition-missing").remove(),e('<p class="condition-missing">'+formbuilder.selections_missing+"</p>").insertBefore(o))}.bind(this))},t.prototype.getOptions=function(t){var o=[];return e('[data-layout="radio"]:not(.acf-clone)').each(function(t,n){var i={groupLabel:e(n).find('[data-name="label"] input').val(),selectvalues:[]};e('[data-key="field_58eb670d39fef"] table tbody',n).children("tr.acf-row:not(.acf-clone)").each(function(t,o){var n=e(o).find('[data-name="value"] input').val();i.selectvalues.push(n)}),o.push(i)}),o},t.prototype.conditionalString=function(e){return e=e.toLowerCase(),e=e.replace(/[^a-z0-9]+/gi,"_"),e=e.replace(/_+$/,"")},t.prototype.handleEvents=function(){e(document).on("click",'[data-name="conditional_logic"] [type="checkbox"], [data-layout="radio"] .acf-row-handle > a',function(){this.populateSelectFields()}.bind(this))},new t}(jQuery);