FormBuilder=FormBuilder||{},FormBuilder.Admin=FormBuilder.Admin||{},FormBuilder.Admin.Conditional=function(t){function e(){t(document).ready(function(){this.populateSelectFields(),this.handleEvents()}.bind(this))}return e.prototype.populateSelectFields=function(){t('[data-name="conditonal_field"] select').each(function(e,n){var i="",a=t(":selected",n);if(a.val())i=a.val();else{var o=t(n).attr("name");t.ajax({url:ajaxurl,type:"post",data:{action:"get_selected_field",moduleId:modularity_current_post_id,fieldName:o},success:function(e){"error"!=e&&t("option[value='"+e+"']",n).prop("selected",!0)}})}t("optgroup, option",n).remove();var r=this.getOptions();"undefined"!=typeof r&&r.length>0?(t(".condition-missing").remove(),t.each(r,function(e,a){var o="";t.each(a.selectvalues,function(t,e){var n=this.conditionalString(a.groupLabel),i=this.conditionalString(e),r={label:n,value:i};o+="<option value='"+JSON.stringify(r)+"'>"+e+"</option>"}.bind(this));var r='<optgroup label="'+a.groupLabel+'">'+o+"</optgroup>";t(n).append(r),i&&t("option[value='"+i+"']",n).prop("selected",!0)}.bind(this))):(t(".condition-missing").remove(),t('<p class="condition-missing">'+formbuilder.selections_missing+"</p>").insertBefore(n))}.bind(this))},e.prototype.getOptions=function(e){var n=[];return t('[data-layout="radio"]:not(.acf-clone)').each(function(e,i){var a=t(i),o=a.find('[data-name="label"] input').val(),r={groupLabel:o,selectvalues:[]};t('[data-key="field_58eb670d39fef"] table tbody',i).children("tr.acf-row:not(.acf-clone)").each(function(e,n){var i=t(n),a=i.find('[data-name="value"] input').val();r.selectvalues.push(a)}),n.push(r)}),n},e.prototype.conditionalString=function(t){return t=t.toLowerCase(),t=t.replace(/\s+/g,"_"),t=t.replace(/[^a-z0-9_]+/gi,""),t=t.replace(/_+$/,"")},e.prototype.handleEvents=function(){t(document).on("click",'[data-name="conditional_logic"] [type="checkbox"], [data-layout="radio"] .acf-row-handle > a',function(){this.populateSelectFields()}.bind(this))},new e}(jQuery);var FormBuilder=FormBuilder||{};FormBuilder=FormBuilder||{},FormBuilder.Admin=FormBuilder.Admin||{},FormBuilder.Admin.Notification=function(t){function e(){t(function(){this.init(),this.dataGathering(),this.updateMainSelect(),this.updateSubSelect(),t('.acf-tab-button, [data-name="condition"]').on("click",function(){this.dataGathering(),this.updateMainSelect(),this.updateSubSelect()}.bind(this)),t("[data-name='form_conditional_field'] .acf-input select").change(function(t){this.updateSubSelect()}.bind(this))}.bind(this))}var n=[];return e.prototype.init=function(){"undefined"!=typeof notificationConditions&&null!==notificationConditions&&(notificationConditions=JSON.parse(notificationConditions),["conditional_field","conditional_field_equals"].forEach(function(e){t("[data-name='notify'] .acf-row:not(.acf-clone)").each(function(n,i){if(null!==notificationConditions[n]){var a=t("[data-name='form_"+e+"'] .acf-input select",i);a.empty(),a.append(t("<option></option>").attr("value",notificationConditions[n][e]).text(notificationConditions[n][e]).attr("selected","selected"))}})}))},e.prototype.updateMainSelect=function(){t("[data-name='notify'] .acf-row:not(.acf-clone)").each(function(e,i){var a=t("[data-name='form_conditional_field'] .acf-input select",i),o=t(a).val();t(a).empty(),t.each(n,function(e,n){o==e?t(a).append(t("<option></option>").attr("value",e).text(e).attr("selected","selected")):t(a).append(t("<option></option>").attr("value",e).text(e))})}.bind(this))},e.prototype.updateSubSelect=function(){t("[data-name='notify'] .acf-row:not(.acf-clone)").each(function(e,i){var a=t("[data-name='form_conditional_field_equals'] .acf-input select",i),o=t("[data-name='form_conditional_field'] .acf-input select",i),r=t(a).val();t(o).val();t(a).empty(),t.each(n,function(e,i){o.val()==e&&t.each(n[e],function(e,n){r==n?t(a).append(t("<option></option>").attr("value",n).text(n).attr("selected","selected")):t(a).append(t("<option></option>").attr("value",n).text(n))})})}.bind(this))},e.prototype.dataGathering=function(){n={},t("[data-name='form_fields'] .layout").each(function(e,i){var a=t(i).attr("data-layout"),o=t(".acf-fields  [data-name='label'] .acf-input .acf-input-wrap input",i).val();if(["select","radio"].indexOf(a)!=-1){console.log(a);var r=t("[data-name='required'] .acf-input label input",i).prop("checked"),d=t("[data-name='conditional_logic'] .acf-input label input",i).prop("checked");if(r&&!d){n[o]=[];var l=t("[data-name='values'] tbody [data-name='value'] .acf-input .acf-input-wrap input[type='text']",i);t(l).filter(function(e,n){return!t(n).attr("name").includes("acfclonefield")}).each(function(e,i){t(i).val()&&o&&n[o].push(t(i).val())}.bind(this))}}})},new e}(jQuery),FormBuilder=FormBuilder||{},FormBuilder.Admin=FormBuilder.Admin||{},FormBuilder.Admin.EditForm=function(t){function e(){t(function(){this.handleEvents()}.bind(this))}return e.prototype.deleteFile=function(e,n,i,a,o){t.ajax({url:ajaxurl,type:"post",data:{action:"delete_file",postId:e,formId:n,filePath:i,fieldName:a},beforeSend:function(t){o.remove()},error:function(t,e,n){console.log("Error: "+e)}})},e.prototype.uploadFile=function(e,n,i,a,o){var r=new FormData;r.append("action","upload_files"),r.append("postId",n),r.append("formId",i),r.append("fieldName",a),t.each(e,function(t,e){r.append(a+"[]",e)}),t.ajax({url:ajaxurl,type:"POST",data:r,cache:!1,dataType:"json",processData:!1,contentType:!1,beforeSend:function(e){t("input[type=file]",o).hide(),t(".upload-status",o).html('<div class="spinner spinner-dark is-active" style="float:none;"></div>')},success:function(e,n,i){e.success&&t(":submit","#publishing-action,#edit-post").trigger("click"),t(".upload-status",o).html("<p>"+e.data+"</p>"),t("input[type=file]",o).show()},error:function(e,n){console.log("error: "+n),t("input[type=file]",o).show(),t(".upload-status",o).hide()}})},e.prototype.savePost=function(e){var n=t(e.target),i=new FormData(e.target);return i.append("action","save_post"),n.find('button[type="submit"]').attr("disabled","true").append('<span class="spinner"></span>'),t.ajax({url:ajaxurl,type:"POST",data:i,dataType:"json",processData:!1,contentType:!1,success:function(e){e.success?n.find('button[type="submit"]').append('<i class="pricon pricon-check"></i>').find(".spinner").hide():t(".modal-footer",n).html('<span class="notice warning"><i class="pricon pricon-notice-warning"></i> '+e.data+"</span>")},complete:function(){location.hash="",location.reload()}}),!1},e.prototype.handleEvents=function(){t(document).on("submit","#edit-post",function(t){t.preventDefault(),this.savePost(t)}.bind(this)),t(document).on("click",".delete-form-file",function(e){if(e.preventDefault(),window.confirm(formbuilder.delete_confirm)){var n=t(e.target).attr("postid"),i=t(e.target).attr("formid"),a=t(e.target).attr("filepath"),o=t(e.target).attr("fieldname"),r=t(e.target).parents("span");this.deleteFile(n,i,a,o,r)}}.bind(this)),t(document).on("change","input[type=file]",function(e){var n=e.target.files,i=t(e.target).attr("postid"),a=t(e.target).attr("formid"),o=t(e.target).attr("fieldname"),r=t(e.target).parents(".mod-form-field");this.uploadFile(n,i,a,o,r)}.bind(this))},new e}(jQuery);var FormBuilder=FormBuilder||{};FormBuilder=FormBuilder||{},FormBuilder.Admin=FormBuilder.Admin||{},FormBuilder.Admin.various=function(t){function e(){t(function(){this.externalUpload()}.bind(this))}return e.prototype.externalUpload=function(){formbuilder.mod_form_authorized||t('[data-name="upload_videos_external"]').hide()},new e}(jQuery);